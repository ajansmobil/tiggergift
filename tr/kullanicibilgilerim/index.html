<!doctype html>
<html lang="tr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="Page-Exit" content="BlendTrans(Duration"="0)" />
  <meta http-equiv="Page-Enter" content="BlendTrans(Duration"="0)" />
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests" />
  <title>Kullanıcı Bilgilerim</title>
  <meta name="description" content="" />
  <meta name="keywords" content="" />
  <meta property="og:title" content="Kullanıcı Bilgilerim" />
  <meta property="og:description" content="" />
  <meta property="og:image" content="https://tiggergift.com/img/icon.png" />
  <meta name="robots" content="index, follow" />
  <link rel="stylesheet" href="/src/css.css?v=q7urc" />
  <link rel="shortcut icon" href="/img/icon.png?v=q7urc" type="image/png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
    rel="stylesheet" />

  <link rel="stylesheet" href="/src/swiper-bundle.min.css" />
  <script src="/src/swiper-bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-messaging.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-functions.js"></script>



<script>
  const firebaseConfig = {
    apiKey: "AIzaSyBW1jNJSUMgje8ZQ_jdT0Kbge9bnOZrlfs",
    authDomain: "tiggergiftcom.firebaseapp.com",
    projectId: "tiggergiftcom",
    storageBucket: "tiggergiftcom.firebasestorage.app",
    messagingSenderId: "869071434601",
    appId: "1:869071434601:web:292f989d265a4a88a6c3f8"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();
</script>


  <script type="text/javascript" src="/src/firebase.js?v=q7urc"></script>
<link rel="stylesheet" href="style.css?v=q7urc">
</head>

<body>
  <div id="header"><header class="rq8vt-header-wrapper">
  <div class="rq8vt-header">
    <div class="rq8vt-header-top">
      <a href="/tr/" class="rq8vt-header-left">
        <img src="/img/logo.png?v=q7urc" alt="Tiggergift Logo" class="rq8vt-logo" />
      </a>

      <div class="rq8vt-search-box">
        <span class="material-symbols-outlined">search</span>
        <input type="text" placeholder="Ürün ara..." />
        <button>Ara</button>
      </div>

      <div class="rq8vt-support-info">
        <span class="material-symbols-outlined">headphones</span>
        <div>
          <small>7/24 Destek</small>
          <strong>+90 342 221 00 02</strong>
        </div>
      </div>

      <div class="rq8vt-icons">
        <a href="/tr/login/" class="material-symbols-outlined">person</a>
        <a href="/tr/favorilerim/" class="material-symbols-outlined">favorite</a>
        <a href="/tr/basket/" class="material-symbols-outlined">shopping_cart</a>
      </div>
    </div>
  </div>

  <div class="rq8vt-header-bottom">
    <div class="rq8vt-header-bottom-inner">
      <button class="rq8vt-category-btn">
        <span class="material-symbols-outlined">menu</span> Kategoriler
      </button>
      <nav class="rq8vt-main-menu"><a href="/tr/urunlerimiz/">Kampanyalı</a><a href="/tr/baklava/">Baklava</a><a href="/tr/kurumsal/">Kurumsal</a><a href="/tr/yerelurunler/">Yerel Ürünler</a><a href="/tr/iletisim/">İletişim</a></nav>
    </div>
  </div>
</header>


</div>
  <div id="content"><!-- Loading Screen -->
<div class="admin-loading-overlay" id="adminLoadingOverlay">
  <div class="admin-loading-content">
    <div class="admin-loading-spinner"></div>
    <div class="admin-loading-text">Giriş kontrol ediliyor...</div>
  </div>
</div>

<!-- Main Content -->
<div class="ghsjw" id="adminMainContent" style="display: none;">
  <div class="ghsjw-menu">
    <a href="/tr/user/" class="ghsjw-profile">
      <div class="ghsjw-user-img" id="userAvatar"></div>
      <div id="userName">Yükleniyor...</div>
    </a>
    <div class="ghsjw-menu-category">
    <a href="/tr/sepetim/" >
      <span class="material-symbols-outlined">shopping_basket</span>
      <div>Sepetim</div>
    </a>
    <a href="/tr/siparislerim/" >
      <span class="material-symbols-outlined">shopping_cart</span>
      <div>Siparişlerim</div>
    </a>
    <a href="/tr/favorilerim/" >
      <span class="material-symbols-outlined">favorite</span>
      <div>Favorilerim</div>
    </a>
    <a href="/tr/bildirimler/" >
      <span class="material-symbols-outlined">notifications</span>
      <div>Bildirimler</div>
    </a>
    <a href="/tr/mesajlar/" >
      <span class="material-symbols-outlined">message</span>
      <div>Mesajlar</div>
    </a>
    <a href="/tr/degerlendirmelerim/" >
      <span class="material-symbols-outlined">stars</span>
      <div>Değerlendirmelerim</div>
    </a>
    <a href="/tr/adreslerim/" >
      <span class="material-symbols-outlined">location_on</span>
      <div>Adreslerim</div>
    </a>
    <a href="/tr/kredikartlarim/" >
      <span class="material-symbols-outlined">credit_card</span>
      <div>Kredi Kartlarım</div>
    </a>
    <a href="/tr/faturalarim/" >
      <span class="material-symbols-outlined">receipt</span>
      <div>Faturalarım</div>
    </a>
    <a href="/tr/iadevedegisim/" >
      <span class="material-symbols-outlined">swap_horiz</span>
      <div>İade ve Değişim</div>
    </a>
    <a href="/tr/cuzdanim/" >
      <span class="material-symbols-outlined">account_balance_wallet</span>
      <div>Cüzdanım</div>
    </a>
    <a href="/tr/cozummerkezi/" >
      <span class="material-symbols-outlined">support</span>
      <div>Çözüm Merkezi</div>
    </a>
    <a href="/tr/kuponlarim/" >
      <span class="material-symbols-outlined">local_offer</span>
      <div>Kuponlarım</div>
    </a>
    <a href="/tr/iletisimtercihlerim/" >
      <span class="material-symbols-outlined">settings</span>
      <div>İletişim Tercihlerim</div>
    </a>
    <a class="ghsjw-menu-active" href="/tr/kullanicibilgilerim/" >
      <span class="material-symbols-outlined">person</span>
      <div>Kullanıcı Bilgilerim</div>
    </a>
    <a href="/tr/uyecikis/" >
      <span class="material-symbols-outlined">exit_to_app</span>
      <div>Üye Çıkış</div>
    </a>
    <a href="/tr/odeme/" >
      <span class="material-symbols-outlined">home</span>
      <div>Ödeme</div>
    </a></div>
  </div>
  <div class="ghsjw-body"><div class="kwfjs">
  <div class="kwfjsTitle">
    <span class="material-symbols-outlined">person</span>
    Kullanıcı Bilgilerim
  </div>
  <div class="kwfjsBody">
    <div class="profile-container">
      <!-- Profil Başlığı -->
      <div class="profile-header">
        <div class="profile-avatar">
          <img src="https://ui-avatars.com/api/?name=John+Doe&background=random" alt="Profil Fotoğrafı" />
          <button class="change-avatar">
            <span class="material-symbols-outlined">photo_camera</span>
          </button>
        </div>
        <div class="profile-info">
          <h2 class="profile-name" id="profileName">Yükleniyor...</h2>
          <div class="profile-meta">
            <span class="member-since" id="memberSince">Üyelik: -</span>
            <span class="last-login" id="lastLogin">Son Giriş: -</span>
          </div>
        </div>
      </div>

      <!-- Tab Menüsü -->
      <div class="profile-tabs">
        <button class="tab-button active" data-tab="profile">Profil Bilgileri</button>
        <button class="tab-button" data-tab="password">Şifre Değiştir</button>
        <button class="tab-button" data-tab="preferences">Tercihler</button>
      </div>

      <!-- Profil Bilgileri Tab -->
      <div class="tab-content active" id="profile-tab">
        <form class="profile-form" id="profileForm">
          <div class="form-section">
            <h3>Profil Bilgileri</h3>
            <div class="form-row">
              <div class="form-group">
                <label>Ad</label>
                <input type="text" name="firstName" id="firstName" required />
              </div>
              <div class="form-group">
                <label>Soyad</label>
                <input type="text" name="lastName" id="lastName" required />
              </div>
            </div>
            <div class="form-group">
              <label>E-posta</label>
              <input type="email" name="email" id="email" required readonly />
              <small style="color: #666; font-size: 0.8em;">E-posta adresi değiştirilemez</small>
            </div>
            <div class="form-group">
              <label>Telefon</label>
              <input type="tel" name="phone" id="phone" />
            </div>
            <div class="form-group">
              <label>Doğum Tarihi</label>
              <input type="date" name="birthDate" id="birthDate" />
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="save-btn">
              <span class="material-symbols-outlined">save</span>
              Güncelle
            </button>
            <button type="button" onclick="fillDemoData()" class="demo-data-btn">
              <span class="material-symbols-outlined">science</span>
              Demo Veri Doldur
            </button>
          </div>
        </form>
      </div>

      <!-- Şifre Değiştir Tab -->
      <div class="tab-content" id="password-tab">
        <form class="password-form" id="passwordForm">
          <div class="form-section">
            <h3>Şifre Değiştir</h3>
            <div class="form-group">
              <label>Mevcut Şifre</label>
              <input type="password" name="currentPassword" required />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Yeni Şifre</label>
                <input type="password" name="newPassword" required />
                <small style="color: #666; font-size: 0.8em;">En az 6 karakter olmalıdır</small>
              </div>
              <div class="form-group">
                <label>Yeni Şifre Tekrar</label>
                <input type="password" name="confirmPassword" required />
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="save-btn">
              <span class="material-symbols-outlined">lock_reset</span>
              Şifreyi Değiştir
            </button>
          </div>
        </form>
      </div>

      <!-- Tercihler Tab -->
      <div class="tab-content" id="preferences-tab">
        <form class="preferences-form" id="preferencesForm">
          <div class="form-section">
            <h3>Tercihler</h3>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="newsletter" />
                E-posta bülteni almak istiyorum
              </label>
            </div>
            <div class="form-group">
              <label class="checkbox-label">
                <input type="checkbox" name="smsNotification" />
                SMS bildirimleri almak istiyorum
              </label>
            </div>
            <div class="form-group">
              <label>Dil Tercihi</label>
              <select name="language">
                <option value="tr">Türkçe</option>
                <option value="en">English</option>
              </select>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="save-btn">
              <span class="material-symbols-outlined">save</span>
              Tercihleri Kaydet
            </button>
          </div>
        </form>
      </div>

      <!-- Hesap Silme -->
      <div class="danger-zone">
        <h3>Tehlikeli Bölge</h3>
        <button class="delete-account">
          <span class="material-symbols-outlined">delete_forever</span>
          Hesabımı Sil
        </button>
      </div>
    </div>
  </div>
</div>



<script>
  // Firebase'den kullanıcı bilgilerini çek
  async function loadUserProfile() {
    try {
      console.log('User state:', user); // Debug için

      if (!user || !user.isLoggedIn || !user.id) {
        console.log('User not logged in or ID missing'); // Debug için
        showNotification('Profil bilgilerinizi görmek için giriş yapmanız gerekiyor.', 'error');
        return;
      }

      // Kullanıcı profil bilgilerini Firebase'den al
      const userSnapshot = await dataListWeb(`users`);
      let userData = null;

      // Kullanıcıyı ID ile bul
      userSnapshot.forEach(doc => {
        if (doc.id === user.id) {
          userData = doc.data();
        }
      });

      if (userData) {

        // Profil bilgilerini doldur
        document.getElementById('profileName').textContent = `${userData.firstName || ''} ${userData.lastName || ''}`.trim() || 'Kullanıcı';
        document.getElementById('memberSince').textContent = `Üyelik: ${formatDate(userData.createdAt)}`;
        document.getElementById('lastLogin').textContent = `Son Giriş: ${formatDate(userData.lastLoginAt)}`;

        // Form alanlarını doldur
        document.getElementById('firstName').value = userData.firstName || '';
        document.getElementById('lastName').value = userData.lastName || '';
        document.getElementById('email').value = userData.email || '';
        document.getElementById('phone').value = userData.phone || '';
        document.getElementById('birthDate').value = userData.birthDate || '';

        // Profil fotoğrafını güncelle
        const avatar = document.querySelector('.profile-avatar img');
        if (userData.photoURL) {
          avatar.src = userData.photoURL;
        } else {
          const fullName = `${userData.firstName || ''} ${userData.lastName || ''}`.trim() || 'User';
          avatar.src = `https://ui-avatars.com/api/?name=${encodeURIComponent(fullName)}&background=random`;
        }

        // Tercihleri doldur
        const newsletterCheckbox = document.querySelector('input[name="newsletter"]');
        const smsCheckbox = document.querySelector('input[name="smsNotification"]');
        const languageSelect = document.querySelector('select[name="language"]');

        if (newsletterCheckbox) newsletterCheckbox.checked = userData.preferences?.newsletter || false;
        if (smsCheckbox) smsCheckbox.checked = userData.preferences?.smsNotification || false;
        if (languageSelect) languageSelect.value = userData.preferences?.language || 'tr';

      } else {
        console.log('User data not found for ID:', user.id); // Debug için
        showNotification('Kullanıcı profili bulunamadı! Yeni profil oluşturuluyor...', 'info');

        // Yeni kullanıcı profili oluştur
        const newUserData = {
          firstName: user.displayName ? user.displayName.split(' ')[0] : '',
          lastName: user.displayName ? user.displayName.split(' ').slice(1).join(' ') : '',
          email: user.email || '',
          phone: '',
          birthDate: '',
          preferences: {
            newsletter: false,
            smsNotification: false,
            language: 'tr'
          },
          createdAt: new Date(),
          updatedAt: new Date()
        };

        await dataAddWeb(`users`, newUserData, user.id);
        showNotification('Profil oluşturuldu! Sayfa yenileniyor...', 'success');

        setTimeout(() => {
          loadUserProfile();
        }, 2000);
      }

    } catch (error) {
      console.error('Profil yüklenirken hata:', error);
      showNotification('Profil bilgileri yüklenirken hata oluştu!', 'error');
    }
  }

  // Profil bilgilerini güncelle
  async function updateProfile(formData) {
    try {
      const updateData = {
        firstName: formData.get('firstName'),
        lastName: formData.get('lastName'),
        phone: formData.get('phone'),
        birthDate: formData.get('birthDate'),
        preferences: {
          newsletter: formData.get('newsletter') === 'on',
          smsNotification: formData.get('smsNotification') === 'on',
          language: formData.get('language')
        },
        updatedAt: new Date()
      };

      await dataUpdateWeb(`users/${user.id}`, updateData);
      showNotification('Profil bilgileri güncellendi!', 'success');

      // Profili yeniden yükle
      setTimeout(() => loadUserProfile(), 1000);

    } catch (error) {
      console.error('Profil güncellenirken hata:', error);
      showNotification('Profil güncellenirken hata oluştu!', 'error');
    }
  }

  // Şifre değiştir
  async function changePassword(currentPassword, newPassword) {
    try {
      // Firebase Auth ile şifre değiştirme
      await authChangePasswordWeb(currentPassword, newPassword);
      showNotification('Şifre başarıyla değiştirildi!', 'success');

      // Form alanlarını temizle
      document.querySelector('input[name="currentPassword"]').value = '';
      document.querySelector('input[name="newPassword"]').value = '';
      document.querySelector('input[name="confirmPassword"]').value = '';

    } catch (error) {
      console.error('Şifre değiştirilirken hata:', error);
      let errorMessage = 'Şifre değiştirilirken hata oluştu!';

      if (error.code === 'auth/wrong-password') {
        errorMessage = 'Mevcut şifre hatalı!';
      } else if (error.code === 'auth/weak-password') {
        errorMessage = 'Yeni şifre çok zayıf!';
      }

      showNotification(errorMessage, 'error');
    }
  }

  // Hesap sil
  async function deleteAccount() {
    if (!confirm('Hesabınızı silmek istediğinizden emin misiniz? Bu işlem geri alınamaz!')) {
      return;
    }

    if (!confirm('Son kez soruyoruz: Hesabınızı kalıcı olarak silmek istediğinizden emin misiniz?')) {
      return;
    }

    try {
      // Kullanıcı verilerini sil
      await dataDeleteWeb(`users/${user.id}`);

      // Firebase Auth hesabını sil
      await authDeleteAccountWeb();

      showNotification('Hesabınız başarıyla silindi. Yönlendiriliyorsunuz...', 'success');

      // Ana sayfaya yönlendir
      setTimeout(() => {
        window.location.href = '/';
      }, 2000);

    } catch (error) {
      console.error('Hesap silinirken hata:', error);
      showNotification('Hesap silinirken hata oluştu!', 'error');
    }
  }

  // Tarih formatla
  function formatDate(timestamp) {
    if (!timestamp) return 'Bilinmiyor';
    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);
    return date.toLocaleDateString('tr-TR');
  }

  // Bildirim göster
  function showNotification(message, type = 'info') {
    const existingNotification = document.querySelector('.notification');
    if (existingNotification) {
      existingNotification.remove();
    }

    const notification = document.createElement('div');
    notification.className = `notification ${type}`;
    notification.innerHTML = `
      <span class="material-symbols-outlined">
        ${type === 'success' ? 'check_circle' : type === 'error' ? 'error' : 'info'}
      </span>
      ${message}
    `;

    notification.style.cssText = `
      position: fixed; top: 20px; right: 20px;
      background: ${type === 'success' ? '#22c55e' : type === 'error' ? '#ef4444' : '#3b82f6'};
      color: white; padding: 12px 16px; border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1000;
      display: flex; align-items: center; gap: 8px; font-weight: 500;
      animation: slideIn 0.3s ease-out;
    `;

    if (!document.querySelector('#notification-styles')) {
      const style = document.createElement('style');
      style.id = 'notification-styles';
      style.textContent = `
        @keyframes slideIn {
          from { transform: translateX(100%); opacity: 0; }
          to { transform: translateX(0); opacity: 1; }
        }
      `;
      document.head.appendChild(style);
    }

    document.body.appendChild(notification);

    setTimeout(() => {
      if (notification.parentNode) {
        notification.remove();
      }
    }, 4000);
  }

  // Tab işlevselliği
  function initializeTabs() {
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');

    tabButtons.forEach(button => {
      button.addEventListener('click', () => {
        const targetTab = button.getAttribute('data-tab');

        // Tüm tab butonlarından active sınıfını kaldır
        tabButtons.forEach(btn => btn.classList.remove('active'));
        // Tüm tab içeriklerini gizle
        tabContents.forEach(content => content.classList.remove('active'));

        // Tıklanan butonu aktif yap
        button.classList.add('active');
        // İlgili tab içeriğini göster
        document.getElementById(targetTab + '-tab').classList.add('active');
      });
    });
  }

  // Authentication state değişikliklerini dinle
  authStateListenerWeb((firebaseUser) => {
    if (firebaseUser) {
      // Kullanıcı giriş yapmış, profil bilgilerini yükle
      setTimeout(() => {
        loadUserProfile();

        // Demo butonunu sadece belirli user ID için göster
        if (user && user.id === 's8RDlo2GsQblcPLWTsMHrudF0sm2') {
          document.querySelector('.demo-data-btn').style.display = 'flex';
        }
      }, 500); // Firebase user objesi güncellenmesi için biraz bekle
    } else {
      // Kullanıcı giriş yapmamış
      showNotification('Profil bilgilerinizi görmek için giriş yapmanız gerekiyor.', 'error');
    }
  });

  // Event listeners
  setTimeout(() => {
    // Tab işlevselliğini başlat
    initializeTabs();

    // Profil formu gönderimi
    const profileForm = document.getElementById("profileForm");
    if (profileForm) {
      profileForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        updateProfile(formData);
      });
    }

    // Şifre değiştirme formu
    const passwordForm = document.getElementById("passwordForm");
    if (passwordForm) {
      passwordForm.addEventListener("submit", (e) => {
        e.preventDefault();

        const currentPassword = e.target.currentPassword.value;
        const newPassword = e.target.newPassword.value;
        const confirmPassword = e.target.confirmPassword.value;

        if (!currentPassword || !newPassword || !confirmPassword) {
          showNotification('Tüm şifre alanlarını doldurun!', 'error');
          return;
        }

        if (newPassword !== confirmPassword) {
          showNotification('Yeni şifreler eşleşmiyor!', 'error');
          return;
        }

        if (newPassword.length < 6) {
          showNotification('Yeni şifre en az 6 karakter olmalıdır!', 'error');
          return;
        }

        changePassword(currentPassword, newPassword);
      });
    }

    // Tercihler formu
    const preferencesForm = document.getElementById("preferencesForm");
    if (preferencesForm) {
      preferencesForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = new FormData(e.target);
        updatePreferences(formData);
      });
    }

    // Profil fotoğrafı değiştirme
    const changeAvatarBtn = document.querySelector(".change-avatar");
    if (changeAvatarBtn) {
      changeAvatarBtn.addEventListener("click", () => {
        showNotification('Profil fotoğrafı değiştirme özelliği geliştiriliyor...', 'info');
      });
    }

    // Hesap silme
    const deleteAccountBtn = document.querySelector(".delete-account");
    if (deleteAccountBtn) {
      deleteAccountBtn.addEventListener("click", () => {
        deleteAccount();
      });
    }
  }, 100);

  // Demo veri doldurma
  function fillDemoData() {
    document.getElementById('firstName').value = 'Demo';
    document.getElementById('lastName').value = 'Kullanıcı';
    document.getElementById('phone').value = '+90 555 000 0000';
    document.getElementById('birthDate').value = '1990-01-01';

    // Tercihleri işaretle
    const newsletterCheckbox = document.querySelector('input[name="newsletter"]');
    const smsCheckbox = document.querySelector('input[name="smsNotification"]');
    const languageSelect = document.querySelector('select[name="language"]');

    if (newsletterCheckbox) newsletterCheckbox.checked = true;
    if (smsCheckbox) smsCheckbox.checked = true;
    if (languageSelect) languageSelect.value = 'tr';

    showNotification('Demo veriler dolduruldu! Kaydet butonuna tıklayın.', 'info');
  }
</script>
</div>
</div>


<script>
  // Firebase'den kullanıcı bilgilerini yükle
  async function loadUserProfile() {
    try {
      // Global user objesini kontrol et
      const currentUser = window.user || {};

      if (!currentUser.isLoggedIn || !currentUser.id) {
        document.getElementById('userName').textContent = 'Admin Kullanıcı';

        // Varsayılan avatar
        const avatarUrl = `https://ui-avatars.com/api/?name=Admin&background=007bff&color=fff&size=40`;
        document.getElementById('userAvatar').style.backgroundImage = `url(${avatarUrl})`;
        document.getElementById('userAvatar').style.backgroundSize = 'cover';
        document.getElementById('userAvatar').style.backgroundPosition = 'center';
        return;
      }

      // Firebase'den kullanıcı bilgilerini almaya çalış
      if (typeof dataListWeb === 'function') {
        try {
          const userSnapshot = await dataListWeb(`users`);
          let userData = null;

          // Kullanıcıyı ID ile bul
          userSnapshot.forEach(doc => {
            if (doc.id === currentUser.id) {
              userData = doc.data();
            }
          });

          if (userData) {
            // Kullanıcı adını güncelle
            const fullName = `${userData.firstName || ''} ${userData.lastName || ''}`.trim();
            document.getElementById('userName').textContent = fullName || userData.email || currentUser.email || 'Kullanıcı';

            // Profil fotoğrafını güncelle
            const avatarElement = document.getElementById('userAvatar');
            if (userData.photoURL) {
              avatarElement.style.backgroundImage = `url(${userData.photoURL})`;
              avatarElement.style.backgroundSize = 'cover';
              avatarElement.style.backgroundPosition = 'center';
            } else {
              // UI Avatars ile otomatik avatar oluştur
              const displayName = fullName || userData.email || currentUser.email || 'U';
              const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=random&color=fff&size=40`;
              avatarElement.style.backgroundImage = `url(${avatarUrl})`;
              avatarElement.style.backgroundSize = 'cover';
              avatarElement.style.backgroundPosition = 'center';
            }
          } else {
            // Kullanıcı verisi bulunamazsa email'den isim çıkar
            const displayName = currentUser.email ? currentUser.email.split('@')[0] : currentUser.name || 'Kullanıcı';
            document.getElementById('userName').textContent = displayName;

            // Varsayılan avatar
            const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=random&color=fff&size=40`;
            document.getElementById('userAvatar').style.backgroundImage = `url(${avatarUrl})`;
            document.getElementById('userAvatar').style.backgroundSize = 'cover';
            document.getElementById('userAvatar').style.backgroundPosition = 'center';
          }
        } catch (fbError) {
          console.log('Firebase veri çekme hatası:', fbError);
          // Firebase hatası varsa localStorage'daki bilgileri kullan
          const displayName = currentUser.email ? currentUser.email.split('@')[0] : currentUser.name || 'Kullanıcı';
          document.getElementById('userName').textContent = displayName;

          const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=007bff&color=fff&size=40`;
          document.getElementById('userAvatar').style.backgroundImage = `url(${avatarUrl})`;
          document.getElementById('userAvatar').style.backgroundSize = 'cover';
          document.getElementById('userAvatar').style.backgroundPosition = 'center';
        }
      } else {
        // dataListWeb fonksiyonu yoksa localStorage bilgilerini kullan
        const displayName = currentUser.email ? currentUser.email.split('@')[0] : currentUser.name || 'Kullanıcı';
        document.getElementById('userName').textContent = displayName;

        const avatarUrl = `https://ui-avatars.com/api/?name=${encodeURIComponent(displayName)}&background=007bff&color=fff&size=40`;
        document.getElementById('userAvatar').style.backgroundImage = `url(${avatarUrl})`;
        document.getElementById('userAvatar').style.backgroundSize = 'cover';
        document.getElementById('userAvatar').style.backgroundPosition = 'center';
      }

    } catch (error) {
      console.error('Kullanıcı profili yüklenirken hata:', error);
      document.getElementById('userName').textContent = 'Admin Kullanıcı';

      const avatarUrl = `https://ui-avatars.com/api/?name=Admin&background=dc3545&color=fff&size=40`;
      document.getElementById('userAvatar').style.backgroundImage = `url(${avatarUrl})`;
      document.getElementById('userAvatar').style.backgroundSize = 'cover';
      document.getElementById('userAvatar').style.backgroundPosition = 'center';
    }
  }

  // Admin sayfası için authentication kontrolü
  function checkAdminAccess() {
    const loadingOverlay = document.getElementById('adminLoadingOverlay');
    const mainContent = document.getElementById('adminMainContent');

    // Önce localStorage'dan user bilgisini kontrol et
    try {
      const storedUser = localStorage.getItem('user');
      if (storedUser) {
        const userData = JSON.parse(storedUser);
        if (userData.isLoggedIn && userData.id) {
          console.log('User authenticated from localStorage:', userData.id);

          // Loading ekranını gizle ve ana içeriği göster
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
            mainContent.style.display = 'flex';

            // Global user objesini güncelle
            if (typeof window.user === 'undefined') {
              window.user = userData;
            }

            // Profil bilgilerini yükle
            loadUserProfile();
          }, 500);
          return;
        }
      }
    } catch (error) {
      console.log('localStorage user kontrolü hatası:', error);
    }

    // Firebase authentication kontrolü (eğer authStateListenerWeb fonksiyonu varsa)
    if (typeof authStateListenerWeb === 'function') {
      authStateListenerWeb((firebaseUser) => {
        if (firebaseUser) {
          // Kullanıcı giriş yapmış
          console.log('User authenticated for admin panel:', firebaseUser.uid);

          // Loading ekranını gizle ve ana içeriği göster
          setTimeout(() => {
            loadingOverlay.style.display = 'none';
            mainContent.style.display = 'flex';

            // Global user objesini güncelle
            if (typeof window.user === 'undefined') {
              window.user = {
                id: firebaseUser.uid,
                email: firebaseUser.email,
                isLoggedIn: true
              };
            }

            // Profil bilgilerini yükle
            loadUserProfile();
          }, 1000);

        } else {
          // Kullanıcı giriş yapmamış - login sayfasına yönlendir
          console.log('User not authenticated, redirecting to login...');

          setTimeout(() => {
            window.location.href = '/tr/login/';
          }, 1500);
        }
      });
    } else {
      // authStateListenerWeb fonksiyonu yoksa, doğrudan ana içeriği göster
      console.log('authStateListenerWeb not available, showing admin content directly');

      setTimeout(() => {
        loadingOverlay.style.display = 'none';
        mainContent.style.display = 'flex';

        // Varsayılan user objesi
        if (typeof window.user === 'undefined') {
          window.user = {
            id: 'demo_user',
            email: 'admin@demo.com',
            isLoggedIn: true
          };
        }

        loadUserProfile();
      }, 500);
    }
  }

  // Firebase fonksiyonları mock'ları (eğer yüklü değilse)
  function initializeFirebaseMocks() {
    if (typeof dataListWeb === 'undefined') {
      console.log('Firebase fonksiyonları bulunamadı, mock fonksiyonlar oluşturuluyor...');

      window.dataListWeb = async function (collection) {
        console.log('Mock dataListWeb çağrıldı:', collection);
        return {
          empty: true,
          forEach: function (callback) {
            // Boş collection
          }
        };
      };

      window.dataAddWeb = async function (collection, data) {
        console.log('Mock dataAddWeb çağrıldı:', collection, data);
        return { id: 'mock_' + Date.now() };
      };

      window.dataUpdateWeb = async function (collection, id, data) {
        console.log('Mock dataUpdateWeb çağrıldı:', collection, id, data);
        return true;
      };

      window.dataDeleteWeb = async function (collection, id) {
        console.log('Mock dataDeleteWeb çağrıldı:', collection, id);
        return true;
      };

      window.authStateListenerWeb = function (callback) {
        console.log('Mock authStateListenerWeb çağrıldı');
        // Varsayılan olarak giriş yapmış user döndür
        setTimeout(() => {
          callback({
            uid: 'mock_user_id',
            email: 'admin@demo.com'
          });
        }, 100);
      };
    }
  }

  // Mock fonksiyonları başlat
  initializeFirebaseMocks();

  // Sayfa yüklendiğinde admin erişim kontrolü yap
  checkAdminAccess();
</script>
</div>
  <div id="footer"><!-- Google Material Icons -->
<link
  href="https://fonts.googleapis.com/icon?family=Material+Icons"
  rel="stylesheet"
/>

<!-- Güven Kutuları Alanı -->
<div class="d2adm-trust-boxes">
      <div class="d2adm-trust-item">
        <span class="material-icons">account_balance_wallet</span>
        <div class="d2adm-trust-text">
          <div class="d2adm-trust-title">100% Güvenli Ödeme</div>
          <div class="d2adm-trust-desc">3D Secure ile Güvenli Ödeme</div>
        </div>
      </div>
    
      <div class="d2adm-trust-item">
        <span class="material-icons">inventory_2</span>
        <div class="d2adm-trust-text">
          <div class="d2adm-trust-title">%100 Orijinal Ürün</div>
          <div class="d2adm-trust-desc">%100 Lisanslı Orijinal Ürün ile Etkinleştirme</div>
        </div>
      </div>
    
      <div class="d2adm-trust-item">
        <span class="material-icons">local_shipping</span>
        <div class="d2adm-trust-text">
          <div class="d2adm-trust-title">Hızlı Teslimat</div>
          <div class="d2adm-trust-desc">Tüm Alışverişlerinizde Online Hızlı Teslimat</div>
        </div>
      </div>
    </div>

<!-- CSS -->

<footer class="footer">
  <div class="waves">
    <div class="wave" id="wave1"></div>
    <div class="wave" id="wave2"></div>
    <div class="wave" id="wave3"></div>
    <div class="wave" id="wave4"></div>
  </div>
  <ul class="social-icon">



    
    

 


    <li class="social-icon__item">
      <a class="social-icon__link" href="#">
        <ion-icon name="logo-facebook"></ion-icon>
      </a>
    </li>
    <li class="social-icon__item">
      <a class="social-icon__link" href="#">
        <ion-icon name="logo-x"></ion-icon>
      </a>
    </li>
    <li class="social-icon__item">
      <a class="social-icon__link" href="#">
        <ion-icon name="logo-linkedin"></ion-icon>
      </a>
    </li>
    <li class="social-icon__item">
      <a class="social-icon__link" href="#">
        <ion-icon name="logo-instagram"></ion-icon>
      </a>
    </li>
  </ul>
  <ul class="menu">
    <li class="menu__item"><a class="menu__link" href="/tr">Anasayfa</a></li><li class="menu__item"><a class="menu__link" href="/tr/urunlerimiz">Kampanyalı</a></li><li class="menu__item"><a class="menu__link" href="/tr/baklava">Baklava</a></li><li class="menu__item"><a class="menu__link" href="/tr/kurumsal">Kurumsal</a></li><li class="menu__item"><a class="menu__link" href="/tr/yerelurunler">Yerel Ürünler</a></li><li class="menu__item"><a class="menu__link" href="/tr/iletisim">İletişim</a></li>
  </ul>
  <p>Tiggergift 2025 cognite. &copy;</p>
</footer>

<a
  href="https://api.whatsapp.com/send/?phone=905320000000&text=&app_absent=0"
  target="_blank"
  class="whatsapp"
>
  <div class="whatsappicon">
    <svg
      _ngcontent-cty-c90=""
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
      viewBox="0 0 32 32"
      class="wa-messenger-svg-whatsapp wh-svg-icon"
    >
      <path
        _ngcontent-cty-c90=""
        d=" M19.11 17.205c-.372 0-1.088 1.39-1.518 1.39a.63.63 0 0 1-.315-.1c-.802-.402-1.504-.817-2.163-1.447-.545-.516-1.146-1.29-1.46-1.963a.426.426 0 0 1-.073-.215c0-.33.99-.945.99-1.49 0-.143-.73-2.09-.832-2.335-.143-.372-.214-.487-.6-.487-.187 0-.36-.043-.53-.043-.302 0-.53.115-.746.315-.688.645-1.032 1.318-1.06 2.264v.114c-.015.99.472 1.977 1.017 2.78 1.23 1.82 2.506 3.41 4.554 4.34.616.287 2.035.888 2.722.888.817 0 2.15-.515 2.478-1.318.13-.33.244-.73.244-1.088 0-.058 0-.144-.03-.215-.1-.172-2.434-1.39-2.678-1.39zm-2.908 7.593c-1.747 0-3.48-.53-4.942-1.49L7.793 24.41l1.132-3.337a8.955 8.955 0 0 1-1.72-5.272c0-4.955 4.04-8.995 8.997-8.995S25.2 10.845 25.2 15.8c0 4.958-4.04 8.998-8.998 8.998zm0-19.798c-5.96 0-10.8 4.842-10.8 10.8 0 1.964.53 3.898 1.546 5.574L5 27.176l5.974-1.92a10.807 10.807 0 0 0 16.03-9.455c0-5.958-4.842-10.8-10.802-10.8z"
        fill-rule="evenodd"
      ></path>
    </svg>
  </div>
  Bize Ulaşın
</a>

</div>
</body>

<link rel="stylesheet"
  href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />



<script type="text/javascript" src="/src/js.js?v=q7urc"></script>
<script src="/src/cookie.js?v=q7urc"></script>

</html>
